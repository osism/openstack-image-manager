---
name: Mirror images

"on":
  push:
    paths:
      - '.github/workflows/mirror-images.yml'
      - 'etc/images.yml'
      - 'src/mirror.py'
    branches:
      - main

jobs:
  mirror-images:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-python@v2
        with:
          python-version: '3.x'
      - run: pip3 install -r requirements.txt
      - run: python3 src/mirror.py --minio-access-key $MINIO_ACCESS_KEY --minio-secret-key $MINIO_SECRET_KEY
        env:
          MINIO_ACCESS_KEY: ${{ secrets.MINIO_ACCESS_KEY }}
          MINIO_SECRET_KEY: ${{ secrets.MINIO_SECRET_KEY }}
